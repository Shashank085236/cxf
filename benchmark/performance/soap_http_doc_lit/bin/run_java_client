#!/bin/bash

OPERARTION=echoComplexTypeDoc
#OPERARTION=echoStringDoc
#OPERARTION=echoBase64Doc
BASEDON=Time
AMOUNT=30
PACKETSIZE=1
THREADS=0
BUILD_XML=build.xml
WSDL=

for i in $@
do 
  if [ "$i" = "-Operation" ]
  then
	OPERATION=$2
  fi

  if [ "$i" = "-BuildFile" ]
  then
        BUILD_XML=$2
  fi

  if [ "$i" = "-BasedOn" ]
  then
	BASEDON=$2
  fi

  if [ "$i" = "-Amount" ]
  then
	AMOUNT=$2
  fi

  if [ "$i" = "-PacketSize" ]
  then
        PACKETSIZE=$2
  fi

  if [ "$i" = "-Threads" ]
  then
	THREADS=$2
  fi

  if [ "$i" = "-WSDL" ]
  then
        WSDL=-Dwsdl.location=$2
  fi

  shift
done

# if on solaris, do this......
#export LD_PRELOAD=/usr/lib/libumem.so.1
#echo $LD_PRELOAD

cd .. 
ant -f $BUILD_XML client $WSDL -Dcxf.running.time=$AMOUNT -Dcxf.operation=$OPERATION -Dcxf.basedon=$BASEDON -Dcxf.packet.size=$PACKETSIZE -Dcxf.threads=$THREADS
